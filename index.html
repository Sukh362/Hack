<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Guard Web Panel</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #111;
            color: #0ff;
            padding: 20px;
        }
        h1 { color: #0f0; }
        .data-box {
            background: #222;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 0 10px #0ff;
        }
        .label { font-weight: bold; }
    </style>
</head>
<body>
    <h1>Guard Web Panel</h1>
    <div class="data-box">
        <div><span class="label">Battery:</span> <span id="battery">--</span>%</div>
        <div><span class="label">Latitude:</span> <span id="lat">--</span></div>
        <div><span class="label">Longitude:</span> <span id="lng">--</span></div>
        <div><span class="label">Installed Apps:</span> <span id="apps">--</span></div>
        <div><span class="label">Used Apps (last 1 min):</span> <span id="usedApps">--</span></div>
        <div><span class="label">Last Updated:</span> <span id="timestamp">--</span></div>
    </div>

    <script>
        const firebaseUrl = "https://guard-7ac92-default-rtdb.firebaseio.com/guard_data/live.json";

        async function fetchData(){
            try {
                const response = await fetch(firebaseUrl);
                const data = await response.json();

                document.getElementById('battery').textContent = data.battery || "--";
                document.getElementById('lat').textContent = data.latitude || "--";
                document.getElementById('lng').textContent = data.longitude || "--";
                document.getElementById('apps').textContent = decodeURIComponent(data.installed_apps || "--");
                document.getElementById('usedApps').textContent = decodeURIComponent(data.used_apps || "--");
                document.getElementById('timestamp').textContent = data.timestamp ? new Date(data.timestamp).toLocaleTimeString() : "--";

            } catch (err) {
                console.log("Fetch error: ", err);
            }
        }

        // Initial fetch
        fetchData();

        // Refresh every 2 seconds
        setInterval(fetchData, 2000);
    </script>
</body>
</html>
