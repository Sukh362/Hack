<!DOCTYPE html>
<html>
<head>
    <title>ParentGuard Web Panel</title>
</head>
<body>
    <h1>Child 1 Microphone Recording</h1>

    <p>Battery: <span id="battery">Loading...</span></p>
    <p>Last Update: <span id="lastUpdate">Loading...</span></p>

    <button onclick="fetchMicRecording()">Play Latest Microphone Audio</button>
    <audio id="audioPlayer" controls></audio>

    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

    <script>
        var firebaseConfig = {
            apiKey: "AIzaSyCF7dwVP_r8qRxXiREFKUPl0gZA_5qgW6s",
            authDomain: "parent-guard-53b4a.firebaseapp.com",
            databaseURL: "https://parent-guard-53b4a-default-rtdb.firebaseio.com/",
            projectId: "parent-guard-53b4a",
            storageBucket: "parent-guard-53b4a.appspot.com",
            messagingSenderId: "946864326298",
            appId: "1:946864326298:android:755a9d8982a19a5a9b8123"
        };

        firebase.initializeApp(firebaseConfig);
        var dbRef = firebase.database().ref('child1');

        // Update battery & lastUpdate
        dbRef.on('value', function(snapshot) {
            var data = snapshot.val();
            if(data){
                document.getElementById('battery').innerText = data.battery || '';
                document.getElementById('lastUpdate').innerText = data.lastUpdate || '';
            }
        });

        function fetchMicRecording() {
            dbRef.child('mic_record').once('value', function(snapshot){
                var micData = snapshot.val();
                if(micData && micData.url){
                    var audio = document.getElementById('audioPlayer');
                    audio.src = micData.url;
                    audio.play();
                } else {
                    alert('No audio recorded yet');
                }
            });
        }
    </script>
</body>
</html>
