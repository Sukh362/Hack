<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ParentGuard Web Panel</title>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<style>
    body { font-family: Arial; background: #121212; color: #fff; padding: 20px; }
    button { padding: 10px 20px; margin: 5px; cursor: pointer; }
    #battery { font-size: 20px; margin-bottom: 15px; }
    audio { display: block; margin-top: 15px; }
</style>
</head>
<body>

<h2>ParentGuard Child Panel</h2>

<div id="battery">Battery: --%</div>

<button onclick="startMic()">Start Microphone</button>
<button onclick="stopMic()">Stop Microphone</button>
<button onclick="fetchAudio()">Fetch Audio</button>

<audio id="audioPlayer" controls></audio>

<script>
  // ðŸ”¹ Firebase Config
  var firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "parent-guard-53b4a.firebaseapp.com",
    databaseURL: "https://parent-guard-53b4a-default-rtdb.firebaseio.com",
    projectId: "parent-guard-53b4a",
    storageBucket: "parent-guard-53b4a.appspot.com",
    messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
    appId: "YOUR_APP_ID"
  };
  firebase.initializeApp(firebaseConfig);
  var db = firebase.database();

  // ðŸ”¹ Show battery
  function updateBatteryUI(snapshot) {
      var battery = snapshot.val().battery || '--';
      document.getElementById('battery').innerText = "Battery: " + battery;
  }
  db.ref("child1").on("value", updateBatteryUI);

  // ðŸ”¹ Microphone Commands
  function startMic() {
      db.ref("commands/mic").set("start");
      alert("Start command sent!");
  }
  function stopMic() {
      db.ref("commands/mic").set("stop");
      alert("Stop command sent!");
  }

  // ðŸ”¹ Fetch Audio
  function fetchAudio() {
      db.ref("mic_record/audio").once("value").then(function(snapshot){
          var base64Audio = snapshot.val();
          if(base64Audio){
              var audioPlayer = document.getElementById("audioPlayer");
              audioPlayer.src = "data:audio/3gp;base64," + base64Audio;
              audioPlayer.play();
          } else {
              alert("No audio available");
          }
      });
  }
</script>
</body>
</html>
